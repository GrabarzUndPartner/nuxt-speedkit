var Q=Object.defineProperty;var V=(i,e,t)=>e in i?Q(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var B=(i,e,t)=>(V(i,typeof e!="symbol"?e+"":e,t),t);import{u as L}from"./C_Ea1MBh.js";import{_ as H,H as I,z as U,o as v,c as A,r as Y,E as F,F as D,v as G,l as J,b as X,i as M,C as p}from"./B7Q0RzLF.js";import{u as O,g as K,B as Z,c as b,L as q}from"./B_35yvsz.js";import{u as W}from"./BKHkBkpP.js";import{S as $,t as tt,n as et,g as st}from"./DXIgxO4I.js";const j=/(!?\(\s*min(-device)?-width)(.|\n)+\(\s*max(-device)?-width|\(\s*width\s*>(=)?(.|\n)+\(\s*width\s*<(=)?|(!?\(.*<(=)?\s*width\s*<(=)?)/i,rt=/\(\s*min(-device)?-width|\(\s*width\s*>(=)?/i,T=/(!?\(\s*max(-device)?-width)(.|\n)+\(\s*min(-device)?-width|\(\s*width\s*<(=)?(.|\n)+\(\s*width\s*>(=)?|(!?\(.*>(=)?\s*width\s*>(=)?)/i,it=/\(\s*max(-device)?-width|\(\s*width\s*<(=)?/i,f=w(j,T,rt),y=w(T,j,it),E=/(!?\(\s*min(-device)?-height)(.|\n)+\(\s*max(-device)?-height|\(\s*height\s*>(=)?(.|\n)+\(\s*height\s*<(=)?|(!?\(.*<(=)?\s*height\s*<(=)?)/i,nt=/\(\s*min(-device)?-height|\(\s*height\s*>(=)?/i,R=/(!?\(\s*max(-device)?-height)(.|\n)+\(\s*min(-device)?-height|\(\s*height\s*<(=)?(.|\n)+\(\s*height\s*>(=)?|(!?\(.*>(=)?\s*height\s*>(=)?)/i,ot=/\(\s*max(-device)?-height|\(\s*height\s*<(=)?/i,g=w(E,R,nt),_=w(R,E,ot),C=/print/i,N=/^print$/i,h=Number.MAX_VALUE;function x(i){let e=/(-?\d*\.?\d+)(ch|em|ex|px|rem)/.exec(i);if(e===null&&(f(i)||g(i))&&(e=/(\d)/.exec(i)),e==="0")return 0;if(e===null)return h;let t=e[1];switch(e[2]){case"ch":t=parseFloat(t)*8.8984375;break;case"em":case"rem":t=parseFloat(t)*16;break;case"ex":t=parseFloat(t)*8.296875;break;case"px":t=parseFloat(t);break}return+t}function w(i,e,t){return function(n){return i.test(n)?!0:e.test(n)?!1:t.test(n)}}function P(i,e){const t=C.test(i),n=N.test(i),r=C.test(e),s=N.test(e);return t&&r?!n&&s?1:n&&!s?-1:i.localeCompare(e):t?1:r?-1:null}function ct(i){const t=(i||{}).unitlessMqAlwaysFirst;function n(r,s){const c=P(r,s);if(c!==null)return c;const a=f(r)||g(r),o=y(r)||_(r),u=f(s)||g(s),l=y(s)||_(s);if(t&&(!a&&!o||!u&&!l))return!a&&!o&&!u&&!l?r.localeCompare(s):!u&&!l?1:-1;{if(a&&l)return-1;if(o&&u)return 1;const m=x(r),d=x(s);return m===h&&d===h?r.localeCompare(s):m===h?1:d===h?-1:m>d?o?-1:1:m<d?o?1:-1:r.localeCompare(s)}}return n.desktopFirst=function(r,s){const c=P(r,s);if(c!==null)return c;const a=f(r)||g(r),o=y(r)||_(r),u=f(s)||g(s),l=y(s)||_(s);if(t&&(!a&&!o||!u&&!l))return!a&&!o&&!u&&!l?r.localeCompare(s):!u&&!l?1:-1;{if(a&&l)return 1;if(o&&u)return-1;const m=x(r),d=x(s);return m===h&&d===h?r.localeCompare(s):m===h?1:d===h?-1:m>d?o?-1:1:m<d?o?1:-1:-r.localeCompare(s)}},n}const at=ct();class S{constructor(e,t={}){B(this,"list",[]);B(this,"sort",!1);t=t||{},this.sort=t.sort||!1,this.list=this.list.concat(Array.from(e||this.list).map(n=>new $(n)))}get length(){return this.list.length}[Symbol.iterator](){return this.list.values()}get key(){return this.list.map(e=>e.key).join("-")}get sorted(){return this.sort?this.list.sort((e,t)=>at(e.media,t.media)):this.list}get style(){return this.list.map(({media:e,width:t,height:n,style:r})=>`
      @media ${e} { .${this.className}::before { padding-top: calc((1 / (${t} / ${n})) * 100%); } }
      @supports (aspect-ratio: 1) {
        @media ${e} { .${this.className} { aspect-ratio: ${t} / ${n}; } }
      }
      ${r}
    `).reverse().join(" ")}get className(){return`picture-${tt(this.sorted.map(({src:e})=>et(e)).join(","))}`}get classNames(){return{picture:this.className,image:this.list.map(e=>e.className)}}getFormats(e,t,n){return this.sorted.reduce((r,s)=>r.concat(e.map(c=>s.modify({format:c,preload:c.includes(t)&&n}))),[])}async getMeta(e,t){const n=await Promise.all(this.sorted.map(r=>{const s=e.getSizes(r.src,{sizes:r.sizes,modifiers:r.getModifiers(),...r.getOptions(t)});return r.getMeta(s.src,t)}));return new S(n)}toJSON(){return this.list}static create(...e){return new this(...e)}}const ut=new Map([["jpg","jpeg"]]),lt={props:{source:{type:$,required:!0},crossorigin:{type:[Boolean,String],default(){return null},validator:i=>["anonymous","use-credentials","",!0,!1].includes(i)}},setup(i){const e=O(),t=I().$booster,n=e.getSizes(i.source.src,{sizes:i.source.sizes,modifiers:i.source.getModifiers(),...i.source.getOptions(t)}),r=U(()=>K(i.crossorigin||t.crossorigin)),s=new $(i.source);return W({link:[n&&s.preload&&s.getPreload(n.srcset,n.sizes,r)].filter(Boolean)}),{config:n,resolvedCrossorigin:r}},computed:{srcset(){return this.config.srcset||this.config.src},type(){return`image/${ut.get(this.source.format)||this.source.format}`}}},mt=["srcset","sizes","media","type"];function dt(i,e,t,n,r,s){return v(),A("source",{srcset:s.srcset,sizes:n.config.sizes,media:t.source.media,type:s.type},null,8,mt)}const ht=H(lt,[["render",dt]]),z=["avif","webp","png","jpg","gif"],ft={components:{PictureSource:ht,BaseImage:Z},props:{sources:{type:[Array,S],required:!0},formats:{type:Array,default(){return null}},title:{type:String,default:null},alt:{type:String,default:null},crossorigin:{type:[Boolean,String],default(){return null},validator:b},sortSources:{type:Boolean,default:!0}},emits:["load"],async setup(i){const{isCritical:e}=L(),t=O(),n=I().$booster,r=S.create(i.sources,{sort:i.sortSources}),s=Y(null);return W(()=>{if(s.value&&s.value.length){const c=s.value.classNames;return{style:[st(s.value,c)]}}}),s.value=await r.getMeta(t,n),{isCritical:e,resolvedFormats:i.formats||n.targetFormats,sourceList:r,metaSources:s,classNames:s.value.classNames}},computed:{formatSources(){const i=Array.from(new Set(z.map(t=>this.resolvedFormats.find(n=>n.includes(t))))).filter(Boolean),e=z.find(t=>this.resolvedFormats.find(n=>n.includes(t)));return this.sourceList.getFormats(i,e,this.isCritical)}},methods:{onLoad(i){this.$emit("load",i)}}};function gt(i,e,t,n,r,s){const c=F("picture-source"),a=F("base-image");return v(),A("picture",{class:M([n.classNames.picture,"nuxt-booster-picture"])},[(v(!0),A(D,null,G(s.formatSources,o=>(v(),J(c,{key:o.key,source:o,crossorigin:t.crossorigin},null,8,["source","crossorigin"]))),128)),X(a,{class:M(n.classNames.image),title:t.title,alt:t.alt,crossorigin:t.crossorigin,width:"0",height:"0",onLoad:s.onLoad},null,8,["class","title","alt","crossorigin","onLoad"])],2)}const k=H(ft,[["render",gt],["__scopeId","data-v-410ea88e"]]),wt={inheritAttrs:!1,props:{hydrate:{type:Boolean,default:!0}},setup(){const{isCritical:i}=L();return{isCritical:i}},render(){return this.hydrate?p(k,{...this.$attrs,critical:this.isCritical}):p(q,{never:!0},[p("noscript",{class:"nuxt-booster-picture-noscript"},[p(k,{...this.$attrs,critical:this.hydrate})])])}};export{wt as _};
